# SPDX-License-Identifier: GPL-2.0-only
#
# gpu-nvme-direct kernel module
#
# Provides userspace access to NVMe BAR0 and GPU P2P DMA mapping
# for direct GPU-to-NVMe data transfers.

obj-m := gpunvme.o

gpunvme-objs := gpunvme_main.o \
                gpunvme_pci.o \
                gpunvme_dma.o \
                gpunvme_chrdev.o

# NVIDIA GPU Direct headers (set NVIDIA_SRC to driver source location)
ifdef NVIDIA_SRC
  ccflags-y += -I$(NVIDIA_SRC) -DHAVE_NV_P2P_H
endif

# nvidia_p2p_* symbols â€” pass NVIDIA_SYMVERS from outer Makefile
ifdef NVIDIA_SYMVERS
  KBUILD_EXTRA_SYMBOLS += $(NVIDIA_SYMVERS)
endif

ccflags-y += -Wall -Werror
